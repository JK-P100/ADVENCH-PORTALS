{"ast":null,"code":"import axios from 'axios';\nconst legalNameRegex = /^[a-zA-Z.\\-| ]+$/;\nconst legalOtherProjectRegex = /^[a-zA-Z.\\-| ]{0,150}$/;\nexport default {\n  data() {\n    return {\n      drawer: false,\n      sales: [],\n      showDetailsModal: false,\n      showAddSaleModal: false,\n      showEditSaleModal: false,\n      selectedSale: {},\n      newSale: {\n        rs_date: '',\n        tcp: '',\n        sales_manager: '',\n        project_name: '',\n        sales_person: '',\n        total: '',\n        buyer_name: '',\n        other_project: ''\n      },\n      editSaleData: {},\n      searchQuery: '',\n      filter: 'All',\n      filters: ['All', 'This Month', 'This Year'],\n      sort: 'Newest',\n      sorts: ['Newest', 'Oldest', 'TCP High-Low', 'TCP Low-High'],\n      dateMenu: false,\n      editDateMenu: false,\n      salesTab: 'yearly',\n      salesManagers: ['JK Polagne', 'Anna Lim', 'Mark Lee', 'Maria Santos', 'Jose Tan'],\n      projectNames: ['Camella', 'Astera', 'Santerra', 'Bria', 'Futura'],\n      displayDate: '',\n      editDisplayDate: '',\n      datePickerValue: '',\n      // for v-date-picker\n      dateError: '',\n      saleRules: {\n        required: v => !!v || 'This field is required',\n        date: v => /^\\d{2}\\/\\d{2}\\/\\d{4}$/.test(v) || 'Date must be dd/mm/yyyy',\n        legalName: v => !v || legalNameRegex.test(v) || 'Only [a-z A-Z . - | ] characters',\n        legalOtherProject: v => !v || legalOtherProjectRegex.test(v) || 'Up to 150 [a-z A-Z . - | ] characters'\n      },\n      addSaleFormValid: false,\n      editSaleFormValid: false,\n      salesManagerToPersons: {\n        'JK Polagne': ['Anna Lim', 'Mark Lee'],\n        'Anna Lim': ['Maria Santos', 'Jose Tan'],\n        'Mark Lee': ['Peter Cruz'],\n        'Maria Santos': ['Liza Reyes'],\n        'Jose Tan': ['Ben Cruz']\n      },\n      salesPersons: [],\n      drawerItems: [{\n        title: 'DASHBOARD',\n        icon: 'mdi-view-dashboard',\n        to: '/dashboard'\n      }, {\n        title: 'CLIENT TRACKING',\n        icon: 'mdi-account-group',\n        to: '/clients'\n      }, {\n        title: 'AGENT TRACKING',\n        icon: 'mdi-account-tie',\n        to: '/agents'\n      }, {\n        title: 'COMMS. MGMT.',\n        icon: 'mdi-message-text-outline',\n        to: '/commission-management'\n      }, {\n        title: 'SALES TRACKING',\n        icon: 'mdi-chart-line',\n        to: '/sales-tracking'\n      }, {\n        title: 'PROPERTY LISTING',\n        icon: 'mdi-home-city-outline',\n        to: {\n          name: 'PropertyListing'\n        }\n      }]\n    };\n  },\n  watch: {\n    'newSale.sales_manager'(val) {\n      if (val && this.salesManagerToPersons[val] && this.salesManagerToPersons[val].length > 0) {\n        this.newSale.sales_person = this.salesManagerToPersons[val][0];\n        this.salesPersons = this.salesManagerToPersons[val];\n      } else {\n        this.newSale.sales_person = '';\n        this.salesPersons = [];\n      }\n    },\n    'newSale.rs_date': {\n      immediate: true,\n      handler(val) {\n        this.displayDate = val ? this.formatDate(val) : '';\n      }\n    },\n    'editSaleData.rs_date': {\n      immediate: false,\n      handler(val) {\n        this.editDisplayDate = val ? this.formatDate(val) : '';\n      }\n    }\n  },\n  computed: {\n    filteredSales() {\n      const query = this.searchQuery.toLowerCase();\n      return this.sales.filter(sale => {\n        return sale.buyer_name.toLowerCase().includes(query) || sale.sales_person.toLowerCase().includes(query) || String(sale.id).toLowerCase().includes(query);\n      });\n    },\n    filteredSalesByTab() {\n      const now = new Date();\n      const startOfWeek = new Date(now);\n      startOfWeek.setDate(now.getDate() - now.getDay());\n      const year = now.getFullYear();\n      const month = now.getMonth();\n      return this.filteredSales.filter(sale => {\n        const saleDate = new Date(sale.rs_date);\n        if (this.salesTab === 'yearly') {\n          return saleDate.getFullYear() === year;\n        } else if (this.salesTab === 'monthly') {\n          return saleDate.getFullYear() === year && saleDate.getMonth() === month;\n        } else if (this.salesTab === 'weekly') {\n          return saleDate >= startOfWeek && saleDate <= now;\n        }\n        return true;\n      });\n    },\n    filteredSalesByTabSorted() {\n      let result = this.filteredSalesByTab;\n      // Filter\n      if (this.filter === 'This Month') {\n        const now = new Date();\n        result = result.filter(sale => {\n          const d = new Date(sale.rs_date);\n          return d.getFullYear() === now.getFullYear() && d.getMonth() === now.getMonth();\n        });\n      } else if (this.filter === 'This Year') {\n        const year = new Date().getFullYear();\n        result = result.filter(sale => new Date(sale.rs_date).getFullYear() === year);\n      }\n      // Sort\n      if (this.sort === 'Newest') {\n        result = result.slice().sort((a, b) => new Date(b.rs_date) - new Date(a.rs_date));\n      } else if (this.sort === 'Oldest') {\n        result = result.slice().sort((a, b) => new Date(a.rs_date) - new Date(b.rs_date));\n      } else if (this.sort === 'TCP High-Low') {\n        result = result.slice().sort((a, b) => b.tcp - a.tcp);\n      } else if (this.sort === 'TCP Low-High') {\n        result = result.slice().sort((a, b) => a.tcp - b.tcp);\n      }\n      return result;\n    },\n    yearlySales() {\n      const year = new Date().getFullYear();\n      return this.sales.filter(sale => new Date(sale.rs_date).getFullYear() === year).reduce((sum, sale) => sum + Number(sale.tcp), 0);\n    },\n    monthlySales() {\n      const now = new Date();\n      return this.sales.filter(sale => {\n        const d = new Date(sale.rs_date);\n        return d.getFullYear() === now.getFullYear() && d.getMonth() === now.getMonth();\n      }).reduce((sum, sale) => sum + Number(sale.tcp), 0);\n    },\n    weeklySales() {\n      const now = new Date();\n      const startOfWeek = new Date(now);\n      startOfWeek.setDate(now.getDate() - now.getDay());\n      return this.sales.filter(sale => {\n        const d = new Date(sale.rs_date);\n        return d >= startOfWeek && d <= now;\n      }).reduce((sum, sale) => sum + Number(sale.tcp), 0);\n    }\n  },\n  mounted() {\n    this.fetchSales();\n  },\n  methods: {\n    openAddSaleModal() {\n      this.newSale.rs_date = '';\n      this.datePickerValue = '';\n      this.showAddSaleModal = true;\n    },\n    addSale() {\n      if (!this.$refs.addSaleForm.validate()) return;\n      // Convert dd/mm/yyyy to yyyy-mm-dd\n      let rs_date = '';\n      if (this.newSale.rs_date && /^\\d{2}\\/\\d{2}\\/\\d{4}$/.test(this.newSale.rs_date)) {\n        const [day, month, year] = this.newSale.rs_date.split('/');\n        rs_date = `${year}-${month}-${day}`;\n      }\n      const payload = {\n        ...this.newSale,\n        rs_date,\n        other_project: this.newSale.other_project || ''\n      };\n      axios.post('http://localhost:3000/api/sales', payload).then(() => {\n        this.fetchSales();\n        this.showAddSaleModal = false;\n        this.newSale = {\n          rs_date: '',\n          tcp: '',\n          sales_manager: '',\n          project_name: '',\n          sales_person: '',\n          total: '',\n          buyer_name: '',\n          other_project: ''\n        };\n        this.$refs.addSaleForm.reset();\n      });\n    },\n    openEditSaleModal(sale) {\n      this.editSaleData = {\n        ...sale\n      };\n      this.showEditSaleModal = true;\n    },\n    saveEditSale() {\n      if (!this.$refs.editSaleForm.validate()) return;\n      const payload = {\n        ...this.editSaleData,\n        rs_date: this.editSaleData.rs_date ? new Date(this.editSaleData.rs_date).toISOString().slice(0, 10) : ''\n      };\n      axios.put(`http://localhost:3000/api/sales/${payload.id}`, payload).then(() => {\n        this.fetchSales();\n        console.error('Error updating sale:', error);\n      });\n    },\n    deleteSale(sale) {\n      if (confirm('Are you sure you want to delete this sale?')) {\n        axios.delete(`http://localhost:3000/api/sales/${sale.id}`).then(() => {\n          this.fetchSales();\n        }).catch(error => {\n          alert('Failed to delete sale.');\n          console.error('Error deleting sale:', error);\n        });\n      }\n    },\n    onDatePicked(val) {\n      // val is YYYY-MM-DD, convert to dd/mm/yyyy\n      if (val) {\n        const [year, month, day] = val.split('-');\n        this.newSale.rs_date = `${day}/${month}/${year}`;\n        this.datePickerValue = val;\n        this.dateMenu = false;\n        this.dateError = '';\n      }\n    },\n    onEditDatePicked(val) {\n      this.editSaleData.rs_date = val;\n      this.editDateMenu = false;\n    },\n    formatDate(dateStr) {\n      if (!dateStr) return '';\n      const d = new Date(dateStr);\n      if (isNaN(d)) return dateStr;\n      const day = String(d.getDate()).padStart(2, '0');\n      const month = String(d.getMonth() + 1).padStart(2, '0');\n      const year = d.getFullYear();\n      return `${day}/${month}/${year}`;\n    },\n    viewSaleDetails(sale) {\n      this.selectedSale = sale;\n      this.showDetailsModal = true;\n    },\n    fetchSales() {\n      axios.get('http://localhost:3000/api/sales').then(response => {\n        this.sales = response.data;\n        console.log('Fetched sales:', this.sales);\n      }).catch(error => {\n        console.error('Error fetching sales:', error);\n      });\n    },\n    logout() {\n      localStorage.removeItem('isAuthenticated');\n      this.$router.push('/login');\n    }\n  }\n};","map":{"version":3,"names":["axios","legalNameRegex","legalOtherProjectRegex","data","drawer","sales","showDetailsModal","showAddSaleModal","showEditSaleModal","selectedSale","newSale","rs_date","tcp","sales_manager","project_name","sales_person","total","buyer_name","other_project","editSaleData","searchQuery","filter","filters","sort","sorts","dateMenu","editDateMenu","salesTab","salesManagers","projectNames","displayDate","editDisplayDate","datePickerValue","dateError","saleRules","required","v","date","test","legalName","legalOtherProject","addSaleFormValid","editSaleFormValid","salesManagerToPersons","salesPersons","drawerItems","title","icon","to","name","watch","newSale.sales_manager","val","length","immediate","handler","formatDate","computed","filteredSales","query","toLowerCase","sale","includes","String","id","filteredSalesByTab","now","Date","startOfWeek","setDate","getDate","getDay","year","getFullYear","month","getMonth","saleDate","filteredSalesByTabSorted","result","d","slice","a","b","yearlySales","reduce","sum","Number","monthlySales","weeklySales","mounted","fetchSales","methods","openAddSaleModal","addSale","$refs","addSaleForm","validate","day","split","payload","post","then","reset","openEditSaleModal","saveEditSale","editSaleForm","toISOString","put","console","error","deleteSale","confirm","delete","catch","alert","onDatePicked","onEditDatePicked","dateStr","isNaN","padStart","viewSaleDetails","get","response","log","logout","localStorage","removeItem","$router","push"],"sources":["C:\\Users\\jann kevin\\Desktop\\ADVENCH PORTALS\\frontend\\src\\components\\SalesTracking.vue"],"sourcesContent":["<template>\n  <v-app>\n    <!-- Navigation Drawer -->\n    <v-navigation-drawer\n      v-model=\"drawer\"\n      app\n      color=\"#f5f5f5\"\n      width=\"260\"\n      class=\"elevation-3 rounded-drawer\"\n    >\n      <!-- Logo and App Name -->\n      <v-sheet color=\"white\" class=\"pa-4 d-flex align-center\" elevation=\"0\">\n        <img src=\"../assets/logo.png\" alt=\"Advench Realty Logo\" style=\"max-width: 48px; margin-right: 12px;\" />\n        <div>\n          <div class=\"font-weight-bold\" style=\"color:#388e3c;\">ADVЕNCH</div>\n          <div class=\"text-caption\" style=\"color:#757575;\">REALTY</div>\n        </div>\n        <v-spacer></v-spacer>\n        <v-btn icon @click=\"drawer = false\">\n          <v-icon color=\"grey darken-2\">mdi-close</v-icon>\n        </v-btn>\n      </v-sheet>\n      <v-divider></v-divider>\n\n      <!-- Navigation List -->\n      <v-list dense nav>\n        <v-list-item\n          v-for=\"item in drawerItems\"\n          :key=\"item.title\"\n          :to=\"item.to\"\n          link\n          class=\"drawer-link\"\n          active-class=\"drawer-link--active\"\n          @click=\"drawer = false\"\n        >\n          <v-list-item-icon>\n            <v-icon :color=\"item.iconColor || 'green darken-2'\">{{ item.icon }}</v-icon>\n          </v-list-item-icon>\n          <v-list-item-title class=\"ml-2\">{{ item.title }}</v-list-item-title>\n        </v-list-item>\n      </v-list>\n      <v-divider class=\"my-2\"></v-divider>\n      <v-list dense>\n        <v-list-item link @click=\"logout\" class=\"drawer-link\">\n          <v-list-item-icon>\n            <v-icon color=\"red darken-1\">mdi-logout</v-icon>\n          </v-list-item-icon>\n          <v-list-item-title class=\"ml-2\">LOGOUT</v-list-item-title>\n        </v-list-item>\n      </v-list>\n    </v-navigation-drawer>\n    <v-main>\n      <v-container fluid class=\"pa-0\" style=\"max-width: 85vw; margin: 0 auto;\">\n        <!-- Header -->\n        <v-row align=\"center\" justify=\"space-between\" class=\"px-4 mt-4\">\n          <v-col cols=\"auto\" class=\"d-flex align-center\">\n            <img src=\"../assets/logo.png\" alt=\"Advench Realty Logo\" style=\"max-width: 60px; margin-right: 12px;\" />\n            <div>\n              <h2 class=\"text-h6 font-weight-bold mb-0\">ADVЕNCH REALTY</h2>\n              <p class=\"text-subtitle-2 mb-0\">AND DEVELOPMENT CO.</p>\n            </div>\n          </v-col>\n          <v-col cols=\"auto\">\n            <v-btn icon @click=\"drawer = true\">\n              <v-icon color=\"green darken-4\">mdi-menu</v-icon>\n            </v-btn>\n          </v-col>\n        </v-row>\n        <!-- Title -->\n        <v-row class=\"mt-6 mb-4\">\n          <v-col cols=\"12\">\n            <h1 class=\"text-h4 font-weight-bold\">SALES TRACKING</h1>\n          </v-col>\n        </v-row>\n\n        <!-- Sales Summary -->\n        <v-row class=\"mb-4\">\n          <v-col cols=\"12\">\n            <v-card class=\"pa-4\" :color=\"salesTab === 'yearly' ? '#e3f2fd' : salesTab === 'monthly' ? '#e8f5e9' : '#fffde7'\">\n              <div class=\"font-weight-bold\">\n                {{ salesTab.charAt(0).toUpperCase() + salesTab.slice(1) }} Sales\n              </div>\n              <div class=\"text-h5\">\n                ₱{{\n                  salesTab === 'yearly' ? yearlySales.toLocaleString() :\n                  salesTab === 'monthly' ? monthlySales.toLocaleString() :\n                  weeklySales.toLocaleString()\n                }}\n              </div>\n            </v-card>\n          </v-col>\n        </v-row>\n\n        <!-- Tabs and Search Row (side by side) -->\n        <v-row class=\"mb-2\" align=\"center\">\n          <v-col cols=\"12\" md=\"7\" class=\"d-flex justify-start\">\n            <v-tabs\n              v-model=\"salesTab\"\n              background-color=\"transparent\"\n              grow\n              class=\"custom-flat-tabs\"\n              slider-color=\"green darken-4\"\n              height=\"48\"\n              style=\"max-width: 500px;\"\n            >\n              <v-tab value=\"yearly\">YEARLY</v-tab>\n              <v-tab value=\"monthly\">MONTHLY</v-tab>\n              <v-tab value=\"weekly\">WEEKLY</v-tab>\n            </v-tabs>\n          </v-col>\n          <v-col cols=\"12\" md=\"5\" class=\"d-flex justify-end\">\n            <v-text-field\n              v-model=\"searchQuery\"\n              prepend-inner-icon=\"mdi-magnify\"\n              label=\"Search...\"\n              outlined\n              dense\n              hide-details\n              style=\"max-width: 500px;\"\n            ></v-text-field>\n          </v-col>\n        </v-row>\n\n        <!-- Table -->\n        <v-row class=\"pa-0 ma-0\" style=\"width: 100%;\">\n          <v-col cols=\"12\" class=\"pa-0 ma-0\" style=\"width: 100%;\">\n            <div class=\"table-container\">\n              <v-simple-table dense class=\"custom-table\">\n                <template v-slot:default>\n                  <thead>\n                    <tr>\n                      <th class=\"table-header id-header\">ID</th>\n                      <th class=\"table-header\">RS Date</th>\n                      <th class=\"table-header\">Sales Manager</th>\n                      <th class=\"table-header\">Sales Person</th>\n                      <th class=\"table-header\">Name of Buyer</th>\n                      <th class=\"table-header\">TCP</th>\n                      <th class=\"table-header\">Project Name</th>\n                      <th class=\"table-header\">Total</th>\n                      <th class=\"table-header\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr v-for=\"(sale, index) in filteredSalesByTabSorted\" :key=\"index\" class=\"table-row\">\n                      <td>{{ sale.id }}</td>\n                      <td>{{ formatDate(sale.rs_date) }}</td>\n                      <td>{{ sale.sales_manager }}</td>\n                      <td>{{ sale.sales_person }}</td>\n                      <td>{{ sale.buyer_name }}</td>\n                      <td>₱{{ sale.tcp ? sale.tcp.toLocaleString() : '' }}</td>\n                      <td>{{ sale.project_name }}</td>\n                      <td>{{ sale.total }}</td>\n                      <td class=\"action-cell\">\n                        <v-btn icon color=\"green darken-2\" class=\"action-btn\" @click=\"openEditSaleModal(sale)\">\n                          <v-icon>mdi-pencil</v-icon>\n                        </v-btn>\n                        <v-btn icon color=\"red darken-2\" class=\"action-btn\" @click=\"deleteSale(sale)\">\n                          <v-icon>mdi-delete</v-icon>\n                        </v-btn>\n                      </td>\n                    </tr>\n                  </tbody>\n                </template>\n              </v-simple-table>\n            </div>\n          </v-col>\n        </v-row>\n        <!-- Add Button -->\n        <v-row justify=\"end\" class=\"mt-4 add-button-row\">\n          <v-col cols=\"auto\">\n            <v-btn color=\"grey darken-1\" dark style=\"width: 200px;\" @click=\"openAddSaleModal\">Add</v-btn>\n          </v-col>\n        </v-row>\n      </v-container>\n      <!-- Sale Details Modal -->\n      <v-dialog v-model=\"showDetailsModal\" max-width=\"500px\">\n        <v-card>\n          <v-card-title>Sale Details</v-card-title>\n          <v-card-text>\n            <p><strong>RS Date:</strong> {{ selectedSale.rs_date }}</p>\n            <p><strong>Buyer Name:</strong> {{ selectedSale.buyer_name }}</p>\n            <p><strong>TCP:</strong> ₱{{ selectedSale.tcp ? selectedSale.tcp.toLocaleString() : '' }}</p>\n            <p><strong>Sales Person:</strong> {{ selectedSale.sales_person }}</p>\n          </v-card-text>\n          <v-card-actions>\n            <v-btn color=\"green darken-1\" text @click=\"showDetailsModal = false\">Close</v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n      <!-- Add Sale Modal -->\n      <v-dialog v-model=\"showAddSaleModal\" max-width=\"600px\">\n        <v-card>\n          <v-card-title class=\"d-flex align-center justify-center\">\n            <img src=\"../assets/logo.png\" alt=\"Advench Realty Logo\" style=\"max-width: 80px; margin-right: 16px;\" />\n            <span class=\"text-h5 font-weight-bold\">Add New Sales</span>\n          </v-card-title>\n          <v-card-text>\n            <v-form ref=\"addSaleForm\" v-model=\"addSaleFormValid\">\n              <v-row>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-menu\n                    v-model=\"dateMenu\"\n                    :close-on-content-click=\"false\"\n                    transition=\"scale-transition\"\n                    offset-y\n                    min-width=\"290px\"\n                  >\n                    <template v-slot:activator=\"{ on, attrs }\">\n                      <v-text-field\n                        v-model=\"newSale.rs_date\"\n                        label=\"Date Disbursed\"\n                        placeholder=\"dd/mm/yyyy\"\n                        readonly\n                        v-bind=\"attrs\"\n                        v-on=\"on\"\n                        dense\n                        outlined\n                        :rules=\"[saleRules.required, saleRules.date]\"\n                        @click=\"dateMenu = true\"\n                        :error-messages=\"dateError\"\n                      ></v-text-field>\n                    </template>\n                    <v-date-picker\n                      v-model=\"datePickerValue\"\n                      @input=\"onDatePicked\"\n                      :max=\"new Date().toISOString().substr(0, 10)\"\n                      no-title\n                    ></v-date-picker>\n                  </v-menu>\n                </v-col>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-text-field v-model=\"newSale.tcp\" label=\"TCP\" :rules=\"[saleRules.required, saleRules.decimal]\" required></v-text-field>\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-select v-model=\"newSale.sales_manager\" :items=\"salesManagers\" label=\"Sales Manager\" outlined dense :rules=\"[saleRules.required]\"></v-select>\n                </v-col>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-select v-model=\"newSale.project_name\" :items=\"projectNames\" label=\"Project Name\" outlined dense :rules=\"[saleRules.required]\"></v-select>\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-text-field v-model=\"newSale.sales_person\" label=\"Sales Person\" outlined dense :rules=\"[saleRules.required]\"></v-text-field>\n                </v-col>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-text-field v-model=\"newSale.total\" label=\"Total\" :rules=\"[saleRules.required, saleRules.decimal]\" outlined dense></v-text-field>\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\">\n                  <v-text-field v-model=\"newSale.buyer_name\" label=\"Name of Buyer\" outlined dense :rules=\"[saleRules.required, saleRules.legalName]\"></v-text-field>\n                </v-col>\n              </v-row>\n          \n            </v-form>\n          </v-card-text>\n          <v-card-actions class=\"d-flex justify-space-between\">\n            <v-btn text color=\"green\" @click=\"showAddSaleModal = false\">Cancel</v-btn>\n            <v-btn color=\"grey darken-1\" dark @click=\"addSale\" :disabled=\"!addSaleFormValid\">Confirm</v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n      <!-- Edit Sale Modal -->\n      <v-dialog v-model=\"showEditSaleModal\" max-width=\"600px\">\n        <v-card>\n          <v-card-title class=\"d-flex align-center justify-center\">\n            <img src=\"../assets/logo.png\" alt=\"Advench Realty Logo\" style=\"max-width: 80px; margin-right: 16px;\" />\n            <span class=\"text-h5 font-weight-bold\">Edit Sale</span>\n          </v-card-title>\n          <v-card-text>\n            <v-form ref=\"editSaleForm\" v-model=\"editSaleFormValid\">\n              <v-row>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-menu\n                    v-model=\"editDateMenu\"\n                    :close-on-content-click=\"false\"\n                    transition=\"scale-transition\"\n                    offset-y\n                    min-width=\"290px\"\n                  >\n                    <template v-slot:activator=\"{ on, attrs }\">\n                      <v-text-field\n                        v-model=\"editDisplayDate\"\n                        label=\"DD/MM/YYYY\"\n                        readonly\n                        v-bind=\"attrs\"\n                        v-on=\"on\"\n                        dense\n                        outlined\n                        hide-details\n                        :rules=\"[saleRules.required, saleRules.date]\"\n                        @click=\"editDateMenu = true\"\n                      ></v-text-field>\n                    </template>\n                    <v-date-picker\n                      v-model=\"editSaleData.rs_date\"\n                      @input=\"onEditDatePicked\"\n                      :max=\"new Date().toISOString().substr(0, 10)\"\n                    ></v-date-picker>\n                  </v-menu>\n                </v-col>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-text-field v-model=\"editSaleData.tcp\" label=\"TCP\" :rules=\"[saleRules.required, saleRules.decimal]\" outlined dense></v-text-field>\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-select v-model=\"editSaleData.sales_manager\" :items=\"salesManagers\" label=\"Sales Manager\" outlined dense :rules=\"[saleRules.required]\"></v-select>\n                </v-col>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-select v-model=\"editSaleData.project_name\" :items=\"projectNames\" label=\"Project Name\" outlined dense :rules=\"[saleRules.required]\"></v-select>\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-text-field v-model=\"editSaleData.sales_person\" label=\"Sales Person\" outlined dense :rules=\"[saleRules.required]\"></v-text-field>\n                </v-col>\n                <v-col cols=\"12\" md=\"6\">\n                  <v-text-field v-model=\"editSaleData.total\" label=\"Total\" :rules=\"[saleRules.required, saleRules.decimal]\" outlined dense></v-text-field>\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\">\n                  <v-text-field v-model=\"editSaleData.buyer_name\" label=\"Name of Buyer\" outlined dense :rules=\"[saleRules.required, saleRules.legalName]\"></v-text-field>\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\">\n                  <v-text-field v-model=\"editSaleData.other_project\" label=\"Other Project\" outlined dense :rules=\"[saleRules.legalOtherProject]\"></v-text-field>\n                </v-col>\n              </v-row>\n            </v-form>\n          </v-card-text>\n          <v-card-actions class=\"d-flex justify-space-between\">\n            <v-btn text color=\"green\" @click=\"showEditSaleModal = false\">Cancel</v-btn>\n            <v-btn color=\"grey darken-1\" dark @click=\"saveEditSale\">Save</v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n    </v-main>\n    <!-- Footer -->\n    <v-footer app color=\"green darken-4\" dark class=\"custom-footer\">\n      <v-container>\n        <span>Copyright © 2023. ADVЕNCH REALTY and development co. All rights Reserved.</span>\n      </v-container>\n    </v-footer>\n  </v-app>\n</template>\n\n<script>\nimport axios from 'axios';\n\nconst legalNameRegex = /^[a-zA-Z.\\-| ]+$/;\nconst legalOtherProjectRegex = /^[a-zA-Z.\\-| ]{0,150}$/;\n\nexport default {\n  data() {\n    return {\n      drawer: false,\n      sales: [],\n      showDetailsModal: false,\n      showAddSaleModal: false,\n      showEditSaleModal: false,\n      selectedSale: {},\n      newSale: {\n        rs_date: '',\n        tcp: '',\n        sales_manager: '',\n        project_name: '',\n        sales_person: '',\n        total: '',\n        buyer_name: '',\n        other_project: '',\n      },\n      editSaleData: {},\n      searchQuery: '',\n      filter: 'All',\n      filters: ['All', 'This Month', 'This Year'],\n      sort: 'Newest',\n      sorts: ['Newest', 'Oldest', 'TCP High-Low', 'TCP Low-High'],\n      dateMenu: false,\n      editDateMenu: false,\n      salesTab: 'yearly',\n      salesManagers: ['JK Polagne', 'Anna Lim', 'Mark Lee', 'Maria Santos', 'Jose Tan'],\n      projectNames: ['Camella', 'Astera', 'Santerra', 'Bria', 'Futura'],\n      displayDate: '',\n      editDisplayDate: '',\n      datePickerValue: '', // for v-date-picker\n      dateError: '',\n      saleRules: {\n        required: v => !!v || 'This field is required',\n        date: v => /^\\d{2}\\/\\d{2}\\/\\d{4}$/.test(v) || 'Date must be dd/mm/yyyy',\n        legalName: v => !v || legalNameRegex.test(v) || 'Only [a-z A-Z . - | ] characters',\n        legalOtherProject: v => !v || legalOtherProjectRegex.test(v) || 'Up to 150 [a-z A-Z . - | ] characters',\n      },\n      addSaleFormValid: false,\n      editSaleFormValid: false,\n      salesManagerToPersons: {\n        'JK Polagne': ['Anna Lim', 'Mark Lee'],\n        'Anna Lim': ['Maria Santos', 'Jose Tan'],\n        'Mark Lee': ['Peter Cruz'],\n        'Maria Santos': ['Liza Reyes'],\n        'Jose Tan': ['Ben Cruz'],\n      },\n      salesPersons: [],\n      drawerItems: [\n        { title: 'DASHBOARD', icon: 'mdi-view-dashboard', to: '/dashboard' },\n        { title: 'CLIENT TRACKING', icon: 'mdi-account-group', to: '/clients' },\n        { title: 'AGENT TRACKING', icon: 'mdi-account-tie', to: '/agents' },\n        { title: 'COMMS. MGMT.', icon: 'mdi-message-text-outline', to: '/commission-management' },\n        { title: 'SALES TRACKING', icon: 'mdi-chart-line', to: '/sales-tracking' },\n        { title: 'PROPERTY LISTING', icon: 'mdi-home-city-outline', to: { name: 'PropertyListing' } },\n      ],\n    };\n  },\n  watch: {\n    'newSale.sales_manager'(val) {\n      if (val && this.salesManagerToPersons[val] && this.salesManagerToPersons[val].length > 0) {\n        this.newSale.sales_person = this.salesManagerToPersons[val][0];\n        this.salesPersons = this.salesManagerToPersons[val];\n      } else {\n        this.newSale.sales_person = '';\n        this.salesPersons = [];\n      }\n    },\n    'newSale.rs_date': {\n      immediate: true,\n      handler(val) {\n        this.displayDate = val ? this.formatDate(val) : '';\n      }\n    },\n    'editSaleData.rs_date': {\n      immediate: false,\n      handler(val) {\n        this.editDisplayDate = val ? this.formatDate(val) : '';\n      }\n    }\n  },\n  computed: {\n    filteredSales() {\n      const query = this.searchQuery.toLowerCase();\n      return this.sales.filter((sale) => {\n        return (\n          sale.buyer_name.toLowerCase().includes(query) ||\n          sale.sales_person.toLowerCase().includes(query) ||\n          String(sale.id).toLowerCase().includes(query)\n        );\n      });\n    },\n    filteredSalesByTab() {\n      const now = new Date();\n      const startOfWeek = new Date(now);\n      startOfWeek.setDate(now.getDate() - now.getDay());\n      const year = now.getFullYear();\n      const month = now.getMonth();\n      return this.filteredSales.filter(sale => {\n        const saleDate = new Date(sale.rs_date);\n        if (this.salesTab === 'yearly') {\n          return saleDate.getFullYear() === year;\n        } else if (this.salesTab === 'monthly') {\n          return saleDate.getFullYear() === year && saleDate.getMonth() === month;\n        } else if (this.salesTab === 'weekly') {\n          return saleDate >= startOfWeek && saleDate <= now;\n        }\n        return true;\n      });\n    },\n    filteredSalesByTabSorted() {\n      let result = this.filteredSalesByTab;\n      // Filter\n      if (this.filter === 'This Month') {\n        const now = new Date();\n        result = result.filter(sale => {\n          const d = new Date(sale.rs_date);\n          return d.getFullYear() === now.getFullYear() && d.getMonth() === now.getMonth();\n        });\n      } else if (this.filter === 'This Year') {\n        const year = new Date().getFullYear();\n        result = result.filter(sale => new Date(sale.rs_date).getFullYear() === year);\n      }\n      // Sort\n      if (this.sort === 'Newest') {\n        result = result.slice().sort((a, b) => new Date(b.rs_date) - new Date(a.rs_date));\n      } else if (this.sort === 'Oldest') {\n        result = result.slice().sort((a, b) => new Date(a.rs_date) - new Date(b.rs_date));\n      } else if (this.sort === 'TCP High-Low') {\n        result = result.slice().sort((a, b) => b.tcp - a.tcp);\n      } else if (this.sort === 'TCP Low-High') {\n        result = result.slice().sort((a, b) => a.tcp - b.tcp);\n      }\n      return result;\n    },\n    yearlySales() {\n      const year = new Date().getFullYear();\n      return this.sales\n        .filter(sale => new Date(sale.rs_date).getFullYear() === year)\n        .reduce((sum, sale) => sum + Number(sale.tcp), 0);\n    },\n    monthlySales() {\n      const now = new Date();\n      return this.sales\n        .filter(sale => {\n          const d = new Date(sale.rs_date);\n          return d.getFullYear() === now.getFullYear() && d.getMonth() === now.getMonth();\n        })\n        .reduce((sum, sale) => sum + Number(sale.tcp), 0);\n    },\n    weeklySales() {\n      const now = new Date();\n      const startOfWeek = new Date(now);\n      startOfWeek.setDate(now.getDate() - now.getDay());\n      return this.sales\n        .filter(sale => {\n          const d = new Date(sale.rs_date);\n          return d >= startOfWeek && d <= now;\n        })\n        .reduce((sum, sale) => sum + Number(sale.tcp), 0);\n    },\n  },\n  mounted() {\n    this.fetchSales();\n  },\n  methods: {\n    openAddSaleModal() {\n      this.newSale.rs_date = '';\n      this.datePickerValue = '';\n      this.showAddSaleModal = true;\n    },\n    addSale() {\n      if (!this.$refs.addSaleForm.validate()) return;\n      // Convert dd/mm/yyyy to yyyy-mm-dd\n      let rs_date = '';\n      if (this.newSale.rs_date && /^\\d{2}\\/\\d{2}\\/\\d{4}$/.test(this.newSale.rs_date)) {\n        const [day, month, year] = this.newSale.rs_date.split('/');\n        rs_date = `${year}-${month}-${day}`;\n      }\n      const payload = {\n        ...this.newSale,\n        rs_date,\n        other_project: this.newSale.other_project || '',\n      };\n      axios.post('http://localhost:3000/api/sales', payload)\n        .then(() => {\n          this.fetchSales();\n          this.showAddSaleModal = false;\n          this.newSale = { rs_date: '', tcp: '', sales_manager: '', project_name: '', sales_person: '', total: '', buyer_name: '', other_project: '' };\n          this.$refs.addSaleForm.reset();\n        });\n    },\n    openEditSaleModal(sale) {\n      this.editSaleData = { ...sale };\n      this.showEditSaleModal = true;\n    },\n    saveEditSale() {\n      if (!this.$refs.editSaleForm.validate()) return;\n      const payload = {\n        ...this.editSaleData,\n        rs_date: this.editSaleData.rs_date\n          ? new Date(this.editSaleData.rs_date).toISOString().slice(0, 10)\n          : '',\n      };\n      axios.put(`http://localhost:3000/api/sales/${payload.id}`, payload)\n        .then(() => {\n          this.fetchSales();\n          console.error('Error updating sale:', error);\n        });\n    },\n    deleteSale(sale) {\n      if (confirm('Are you sure you want to delete this sale?')) {\n        axios.delete(`http://localhost:3000/api/sales/${sale.id}`)\n          .then(() => {\n            this.fetchSales();\n          })\n          .catch(error => {\n            alert('Failed to delete sale.');\n            console.error('Error deleting sale:', error);\n          });\n      }\n    },\n    onDatePicked(val) {\n      // val is YYYY-MM-DD, convert to dd/mm/yyyy\n      if (val) {\n        const [year, month, day] = val.split('-');\n        this.newSale.rs_date = `${day}/${month}/${year}`;\n        this.datePickerValue = val;\n        this.dateMenu = false;\n        this.dateError = '';\n      }\n    },\n    onEditDatePicked(val) {\n      this.editSaleData.rs_date = val;\n      this.editDateMenu = false;\n    },\n    formatDate(dateStr) {\n      if (!dateStr) return '';\n      const d = new Date(dateStr);\n      if (isNaN(d)) return dateStr;\n      const day = String(d.getDate()).padStart(2, '0');\n      const month = String(d.getMonth() + 1).padStart(2, '0');\n      const year = d.getFullYear();\n      return `${day}/${month}/${year}`;\n    },\n    viewSaleDetails(sale) {\n      this.selectedSale = sale;\n      this.showDetailsModal = true;\n    },\n    fetchSales() {\n      axios.get('http://localhost:3000/api/sales')\n        .then(response => {\n          this.sales = response.data;\n          console.log('Fetched sales:', this.sales);\n        })\n        .catch(error => {\n          console.error('Error fetching sales:', error);\n        });\n    },\n    logout() {\n      localStorage.removeItem('isAuthenticated');\n      this.$router.push('/login');\n    },\n  },\n};\n</script>\n\n<style>\n.rounded-drawer {\n  border-top-right-radius: 18px;\n  border-bottom-right-radius: 18px;\n}\n.drawer-link {\n  border-radius: 8px;\n  margin: 2px 4px;\n  transition: background 0.2s;\n}\n.drawer-link:hover {\n  background: #e0f2f1 !important;\n}\n.drawer-link--active {\n  background: #c8e6c9 !important;\n  font-weight: bold;\n}\n.table-container {\n  max-height: 500px;\n  overflow-y: auto;\n  border: 1px solid #ccc;\n  border-radius: 12px;\n  background: transparent;\n  padding: 0;\n}\n.custom-table {\n  width: 100%;\n  border-collapse: separate;\n  border-spacing: 0 12px; /* space between rows */\n  table-layout: fixed;\n  background: transparent;\n}\n.table-header,\nth,\ntd {\n  text-align: center !important;\n  vertical-align: middle !important;\n  padding: 16px 12px;\n  font-size: 1rem;\n}\n.id-header {\n  width: 60px !important;\n  min-width: 40px !important;\n  max-width: 80px !important;\n  text-align: center;\n}\n.table-row {\n  background-color: #fff;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(60,60,60,0.04);\n  transition: box-shadow 0.2s;\n}\n.table-row:hover {\n  box-shadow: 0 4px 16px rgba(60,60,60,0.10);\n  background: #f5f5f5;\n}\n.table-row td {\n  padding: 16px 14px;\n  border: none;\n  font-size: 0.98rem;\n  vertical-align: middle;\n  background: transparent;\n}\n.action-cell {\n  display: flex;\n  flex-direction: row;\n  gap: 24px;\n  justify-content: center;\n  align-items: center;\n  min-width: 120px;\n}\n.action-btn {\n  margin: 0;\n}\nth, td {\n  text-align: center !important;\n  vertical-align: middle !important;\n}\nhtml, body, #app, .v-application {\n  height: 100%;\n  margin: 0;\n}\n.v-app {\n  display: flex;\n  flex-direction: column;\n  min-height: 100%;\n}\n.v-main {\n  flex: 1;\n}\n.custom-footer {\n  background-color: #4CAF50;\n  color: white;\n  height: 50px;\n}\n.add-button-row {\n  margin-bottom: 24px;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}